---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

# untrader

<!-- badges: start -->
[![R CMD Check](https://github.com/datapumpernickel/untrader/actions/workflows/R-CMD-check.yaml/badge.svg)](https://github.com/datapumpernickel/untrader/actions/workflows/R-CMD-check.yaml)
<!-- badges: end -->

The goal of untrader is to provide a simple wrapper function for the new [Comtrade API of the UN](https://comtradeplus.un.org/). 

The package is currently under development, please be careful when interpreting results from the API. 

## Installation

You can install the development version of untrader like so:

``` r
devtools::install_github('datapumpernickel/untrader')
```

## Example

This is a basic example which shows you how to solve a common problem:

```{r example}
library(untrader)

## you need to set your API key first
# set_primary_comtrade_key()

exports <- get_comtrade_data(freq = 'A',
                   clCode = 'HS',
                   cmdCode = '2204,2203',
                   flowCode = 'X',
                   reporterCode = "ARG,GBR",
                   partnerCode = 'world',
                   period = "2018,2019,2020,2021",
                  process = T)

ggplot2::ggplot(exports) +
  ggplot2::geom_col(ggplot2::aes(
    x = period,
    y = primaryValue / 1000000,
    fill = stringr::str_wrap(cmd_description,30)
  ),
  position = 'dodge') +
  ggplot2::facet_wrap(. ~ reporter_description) +
  ggplot2::theme_minimal() +
  ggplot2::scale_fill_manual(name = "HS Code", values = c('#F3B562','#F06060'))+
  ggplot2::ylab("Exports in Million USD") +
  ggplot2::xlab("Year") +
  ggplot2::labs(title = 'Exports of Wine and Beer from Great Britain and Argentina')
```


## Next steps

- [ ] Implement tests for unchecked arguments, such as period, motCode and the frequency. 
- [ ] Implement the different modes of transportation
- [ ] Properly document all functions, including some more links to the UN Comtrade API FAQ. 
