---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

# untrader

<!-- badges: start -->
[![R CMD Check](https://github.com/datapumpernickel/untrader/actions/workflows/R-CMD-check.yaml/badge.svg)](https://github.com/datapumpernickel/untrader/actions/workflows/R-CMD-check.yaml)
<!-- badges: end -->

## ðŸš§ Under development - Looking for help ðŸ¤—

The goal of untrader is to provide a simple wrapper function for the new [Comtrade API of the UN](https://comtradeplus.un.org/). The legacy API was very nicely wrapped in the [comtradr](https://github.com/ropensci/comtradr) package. Since there have been extensive changes to the API, I have decided to have a clean start with a new wrapper for the new API. However, a lot of the structure and set-up has been inspired from the original `comtradr` package and one function (check_date() function) has been entirely copied over with minor changes. 

Let me know, if you would like to be part of the developing process and help maintain the package!




## Installation

You can install the development version of untrader like so:

``` r
devtools::install_github('datapumpernickel/untrader')
```

## Example

This is a basic example which shows you how to solve a common problem:

```{r message=T, example}
library(untrader)
library(ggplot2)
library(stringr)

## you need to set your API key first
# set_primary_comtrade_key()

exports <- get_comtrade_data(frequency =  'A',
                   commodity_classification = 'HS',
                   commodity_code = c('2204','2203'),
                   flow_direction = 'export',
                   reporter = c("ARG","GBR"),
                   partner = 'world',
                   start_date = "2018",
                   end_date = "2021",
                   verbose = T,
                  process = T)


str(exports)

ggplot(exports) +
  geom_col(aes(
    x = period,
    y = primaryValue / 1000000,
    fill = str_wrap(cmd_description,30)
  ),
  position = 'dodge') +
  facet_wrap(. ~ reporter_description) +
  theme_minimal() +
  scale_fill_manual(name = "HS Code", values = c('#F3B562','#F06060'))+
  ylab("Exports in Million USD") +
  xlab("Year") +
  labs(title = 'Exports of Wine and Beer from Great Britain and Argentina')
```


## Next steps

- [ ] Implement the different modes of transportation and different commodity codes, as well as customCodes and partner2codes

- [ ] Implement access to the services API

- [ ] Include some more links to the UN Comtrade API FAQ. 
